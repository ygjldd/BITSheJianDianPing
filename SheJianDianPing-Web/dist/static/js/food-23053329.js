import{_ as k,a as w,r as s,c as I,b as e,w as o,o as A,d as m,e as u,p as F,f as T}from"./index-858ac1df.js";import{m as V}from"./message-dfea8e68.js";const j={data(){return{tableData:null,canteen_num:null,floor_num:null,window_num:null,dialogVisible:!1,dishIdToDelete:null,addFoodDialogVisible:!1,newDish:{canteen:null,description:"",discount:null,flavor:null,floor:null,id:null,name:"",photo:"",price:null,window:null}}},methods:{async fetchData(){const l={method:"get",url:`test/api/admin_page/get_dish_list?canteen=${this.canteen_num}&floor=${this.floor_num}&window=${this.window_num}`,headers:{"User-Agent":"Apifox/1.0.0 (https://apifox.com)"}};w(l).then(f=>{this.tableData=f.data.data.list,V("当前窗口有"+this.tableData.length+"件菜品",{type:"success"})}).catch(f=>{})},handleDelete(n){this.dialogVisible=!0,this.dishIdToDelete=n},async confirmDelete(){try{const n=await w.delete("test/api/admin_page/delete_dish",{headers:{"User-Agent":"Apifox/1.0.0 (https://apifox.com)","Content-Type":"application/json"},data:{id:this.dishIdToDelete}});n.data.code===200?(this.tableData=this.tableData.filter(l=>l.id!==this.dishIdToDelete),V("删除成功:"+n.data.message,{type:"success"})):(V("删除失败:"+n.data.message,{teype:"error"}),console.error("删除失败:",n.data.message)),this.fetchData(),this.dialogVisible=!1}catch(n){console.error(n)}this.dialogVisible=!1},openAddFoodDialog(){this.addFoodDialogVisible=!0},async submitNewDish(){this.newDish.canteen=this.canteen_num,this.newDish.floor=this.floor_num,this.newDish.window=this.window_num;try{const n=await w.post("/test/api/admin_page/add_dish",this.newDish,{headers:{"User-Agent":"Apifox/1.0.0 (https://apifox.com)","Content-Type":"application/json"}});n.data.code===200?(this.addFoodDialogVisible=!1,this.fetchData()):console.error("添加菜品失败:",n.data.message)}catch(n){console.error(n)}}}},y=n=>(F("data-v-8162df1a"),n=n(),T(),n),N={class:"table_container"},z={class:"table-container"},B=y(()=>m("div",{class:"card-header"},[m("span",null,"选择食堂编号、楼层和窗口号")],-1)),S={class:"dialog-content"},E=y(()=>m("p",{class:"dialog-message"},"确定删除该菜品吗?",-1)),q={class:"dialog-footer"},G={class:"dialog-footer"};function H(n,l,f,J,t,_){const x=s("el-tag"),i=s("el-option"),h=s("el-select"),d=s("el-form-item"),c=s("el-input-number"),r=s("el-button"),D=s("el-form"),C=s("el-card"),g=s("el-space"),p=s("el-table-column"),U=s("el-table"),v=s("el-dialog"),b=s("el-input");return A(),I("div",N,[e(g,{direction:"vertical",size:"large"},{default:o(()=>[m("div",z,[e(g,{direction:"vertical",size:"large"},{default:o(()=>[e(x,{style:{width:"77vw",justifyContent:"left"},size:"large"},{default:o(()=>[u(" 在此处选择食堂编号、楼层和窗口号 ")]),_:1}),e(C,{shadow:"never",style:{width:"77vw",justifyContent:"center"}},{header:o(()=>[B]),default:o(()=>[e(D,{model:n.formData,"label-width":"120px"},{default:o(()=>[e(d,{label:"选择食堂编号"},{default:o(()=>[e(h,{modelValue:t.canteen_num,"onUpdate:modelValue":l[0]||(l[0]=a=>t.canteen_num=a),placeholder:"请选择食堂编号"},{default:o(()=>[e(i,{label:"北食堂",value:"1"}),e(i,{label:"清真食堂",value:"2"}),e(i,{label:"南食堂",value:"3"}),e(i,{label:"东食堂",value:"4"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"选择楼层"},{default:o(()=>[e(h,{modelValue:t.floor_num,"onUpdate:modelValue":l[1]||(l[1]=a=>t.floor_num=a),placeholder:"请选择楼层"},{default:o(()=>[e(i,{label:"楼层1",value:"1"}),e(i,{label:"楼层2",value:"2"}),e(i,{label:"楼层3",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"窗口号"},{default:o(()=>[e(c,{modelValue:t.window_num,"onUpdate:modelValue":l[2]||(l[2]=a=>t.window_num=a),placeholder:"窗口号"},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(r,{onClick:_.fetchData,type:"primary"},{default:o(()=>[u(" 获取选定窗口的菜品 ")]),_:1},8,["onClick"]),e(r,{onClick:_.openAddFoodDialog,type:"primary"},{default:o(()=>[u(" 向选定窗口添加菜品 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(U,{data:t.tableData,style:{width:"77vw",justifyContent:"center"}},{default:o(()=>[e(p,{prop:"id",label:"菜品ID",width:"120"}),e(p,{prop:"name",label:"菜品名",width:"120"}),e(p,{prop:"description",label:"菜品描述"}),e(p,{prop:"discount",label:"折扣"}),e(p,{prop:"flavor",label:"口味"}),e(p,{prop:"price",label:"价格"}),e(p,{label:"操作",fixed:"right",width:"100"},{default:o(({row:a})=>[e(r,{type:"danger",onClick:K=>_.handleDelete(a.id)},{default:o(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(v,{modelValue:t.dialogVisible,"onUpdate:modelValue":l[4]||(l[4]=a=>t.dialogVisible=a),title:"提示",width:"30%"},{default:o(()=>[m("div",S,[E,m("div",q,[e(r,{onClick:l[3]||(l[3]=a=>t.dialogVisible=!1)},{default:o(()=>[u("取消")]),_:1}),e(r,{type:"primary",onClick:_.confirmDelete},{default:o(()=>[u("确定")]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),e(v,{modelValue:t.addFoodDialogVisible,"onUpdate:modelValue":l[13]||(l[13]=a=>t.addFoodDialogVisible=a),title:"添加菜品",width:"50%"},{default:o(()=>[e(D,{model:"newDish"},{default:o(()=>[e(d,{label:"菜品名","label-width":"80px"},{default:o(()=>[e(b,{modelValue:t.newDish.name,"onUpdate:modelValue":l[5]||(l[5]=a=>t.newDish.name=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"菜品描述","label-width":"80px"},{default:o(()=>[e(b,{modelValue:t.newDish.description,"onUpdate:modelValue":l[6]||(l[6]=a=>t.newDish.description=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"折扣","label-width":"80px"},{default:o(()=>[e(c,{modelValue:t.newDish.discount,"onUpdate:modelValue":l[7]||(l[7]=a=>t.newDish.discount=a),min:0,max:1,step:"0.01"},null,8,["modelValue"])]),_:1}),e(d,{label:"口味","label-width":"80px"},{default:o(()=>[e(h,{modelValue:t.newDish.flavor,"onUpdate:modelValue":l[8]||(l[8]=a=>t.newDish.flavor=a)},{default:o(()=>[e(i,{label:"酸",value:"0"}),e(i,{label:"甜",value:"1"}),e(i,{label:"苦",value:"2"}),e(i,{label:"辣",value:"3"}),e(i,{label:"咸",value:"4"}),e(i,{label:"鲜",value:"5"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"菜品ID","label-width":"80px"},{default:o(()=>[e(c,{modelValue:t.newDish.id,"onUpdate:modelValue":l[9]||(l[9]=a=>t.newDish.id=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"图片","label-width":"80px"},{default:o(()=>[e(b,{modelValue:t.newDish.photo,"onUpdate:modelValue":l[10]||(l[10]=a=>t.newDish.photo=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"价格","label-width":"80px"},{default:o(()=>[e(c,{modelValue:t.newDish.price,"onUpdate:modelValue":l[11]||(l[11]=a=>t.newDish.price=a),min:0},null,8,["modelValue"])]),_:1})]),_:1}),m("span",G,[e(r,{onClick:l[12]||(l[12]=a=>t.addFoodDialogVisible=!1)},{default:o(()=>[u("取消")]),_:1}),e(r,{type:"primary",onClick:_.submitNewDish},{default:o(()=>[u("提交")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])])]),_:1})])}const O=k(j,[["render",H],["__scopeId","data-v-8162df1a"]]);export{O as default};
