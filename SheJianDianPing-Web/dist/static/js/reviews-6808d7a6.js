import{_ as j,a as b,r as o,c as y,b as e,w as a,o as h,e as p,B,N as V,d as f,p as N,f as T}from"./index-858ac1df.js";import{m as _}from"./message-dfea8e68.js";const z={name:"MyTable",data(){return{data:[],dialogVisible:!1,selectedRow:null,canteen_num:null,floor_num:null,window_num:null,test_string:"adsfasdfasdfasdfasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasdaasdddsasda"}},methods:{async fetch_review(){const s={canteen:this.canteen_num,floor:this.floor_num,window:this.window_num},n={method:"get",url:`/test/api/admin_page/get_comment?canteen=${s.canteen}&floor=${s.floor}&window=${s.window}`,headers:{"User-Agent":"Apifox/1.0.0 (https://apifox.com)"}};b(n).then(d=>{this.data=d.data.data.list,d.data.code==200?_("评论拉取成功",{type:"success"}):_("评论拉取失败",{type:"error"})}).catch(function(d){})},async delete_review(){const s={commentID:this.selectedRow.commentid};b({method:"delete",url:"/test/api/admin_page/delete_comment",headers:{"User-Agent":"Apifox/1.0.0 (https://apifox.com)","Content-Type":"application/json"},data:s}).then(function(d){d.data.code==200?_("评论删除成功",{type:"success"}):_("评论删除失败",{type:"error"})}).catch(function(d){}),this.dialogVisible=!1,this.fetch_review()},async ban_user(){const s={userID:this.selectedRow.id};b({method:"post",url:"/test/api/admin_page/ban",headers:{"User-Agent":"Apifox/1.0.0 (https://apifox.com)","Content-Type":"application/json"},data:s}).then(d=>{d.data.code==200&&_("用户"+this.selectedRow.name+"已被封禁",{type:"success"})}).catch(function(d){}),this.dialogVisible=!1},showDetail(s){this.selectedRow=s,this.dialogVisible=!0}}},S=s=>(N("data-v-6eb8469c"),s=s(),T(),s),q={class:"table-container"},E=S(()=>f("div",{class:"card-header"},[f("span",null,"选择食堂编号、楼层和窗口号")],-1)),M={key:0},F=["src"],G={class:"dialog-footer",style:{"margin-top":"20px"}};function H(s,n,d,J,t,u){const x=o("el-tag"),i=o("el-option"),w=o("el-select"),r=o("el-form-item"),C=o("el-input-number"),m=o("el-button"),g=o("el-form"),k=o("el-card"),I=o("el-space"),l=o("el-table-column"),v=o("el-table"),D=o("el-main"),R=o("el-scrollbar"),U=o("el-input"),A=o("el-dialog");return h(),y("div",q,[e(I,{direction:"vertical",size:"large"},{default:a(()=>[e(x,{style:{width:"77vw",justifyContent:"left"},size:"large"},{default:a(()=>[p(" 在此处选择食堂编号、楼层和窗口号 ")]),_:1}),e(k,{shadow:"never",style:{width:"77vw",justifyContent:"center"}},{header:a(()=>[E]),default:a(()=>[e(g,{model:s.formData,"label-width":"120px"},{default:a(()=>[e(r,{label:"选择食堂编号"},{default:a(()=>[e(w,{modelValue:t.canteen_num,"onUpdate:modelValue":n[0]||(n[0]=c=>t.canteen_num=c),placeholder:"请选择食堂编号"},{default:a(()=>[e(i,{label:"北食堂",value:"1"}),e(i,{label:"清真食堂",value:"2"}),e(i,{label:"南食堂",value:"3"}),e(i,{label:"东食堂",value:"4"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"选择楼层"},{default:a(()=>[e(w,{modelValue:t.floor_num,"onUpdate:modelValue":n[1]||(n[1]=c=>t.floor_num=c),placeholder:"请选择楼层"},{default:a(()=>[e(i,{label:"楼层1",value:"1"}),e(i,{label:"楼层2",value:"2"}),e(i,{label:"楼层3",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"窗口号"},{default:a(()=>[e(C,{modelValue:t.window_num,"onUpdate:modelValue":n[2]||(n[2]=c=>t.window_num=c),placeholder:"窗口号"},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(m,{onClick:u.fetch_review,type:"primary"},{default:a(()=>[p(" 从数据库获取所有用户评论 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(D,null,{default:a(()=>[t.data?(h(),B(v,{key:0,data:t.data,style:{width:"77vw",justifyContent:"center"}},{default:a(()=>[e(l,{label:"菜名",prop:"dishname"}),e(l,{label:"菜品ID",prop:"dishid"}),e(l,{label:"价格",prop:"price"}),e(l,{label:"折扣",prop:"discount"}),e(l,{label:"评价",prop:"comment"}),e(l,{label:"用户名",prop:"name"}),e(l,{label:"图片",prop:"photo"}),e(l,{label:"点赞",prop:"goodnumber"}),e(l,{label:"否定",prop:"badnumber"}),e(l,{label:"操作"},{default:a(({row:c})=>[e(m,{type:"text",onClick:K=>u.showDetail(c)},{default:a(()=>[p("详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):V("",!0)]),_:1}),e(A,{modelValue:t.dialogVisible,"onUpdate:modelValue":n[4]||(n[4]=c=>t.dialogVisible=c),title:"详细内容",width:"60%"},{default:a(()=>[t.selectedRow?(h(),y("div",M,[e(R,{style:{height:"300px"}},{default:a(()=>[e(v,{data:[t.selectedRow],"max-height":"250"},{default:a(()=>[e(l,{prop:"photo",label:"照片","class-name":"cell-class"},{default:a(()=>[f("img",{src:t.selectedRow.photo,alt:"photo"},null,8,F)]),_:1}),e(l,{prop:"commentid",label:"评论ID","class-name":"cell-class"}),e(l,{prop:"dishid",label:"菜品ID","class-name":"cell-class"}),e(l,{prop:"dishname",label:"菜名","class-name":"cell-class"}),e(l,{prop:"id",label:"ID","class-name":"cell-class"}),e(l,{prop:"name",label:"名称","class-name":"cell-class"}),e(l,{prop:"datetime",label:"日期时间","class-name":"cell-class"}),e(l,{prop:"goodnumber",label:"点赞","class-name":"cell-class"}),e(l,{prop:"badnumber",label:"否定","class-name":"cell-class"}),e(l,{prop:"discount",label:"折扣","class-name":"cell-class"}),e(l,{prop:"price",label:"价格","class-name":"cell-class"}),e(l,{prop:"description",label:"描述","class-name":"cell-class"}),e(l,{prop:"taste",label:"口味","class-name":"cell-class"}),e(l,{prop:"environment",label:"环境","class-name":"cell-class"}),e(l,{prop:"serve",label:"服务","class-name":"cell-class"})]),_:1},8,["data"])]),_:1})])):V("",!0),e(g,{"label-position":"left",style:{"margin-top":"0px"}},{default:a(()=>[e(r,{label:"评价内容"},{default:a(()=>[e(U,{type:"textarea",rows:10,value:t.selectedRow.comment,readonly:!0,autosize:"",style:{height:"80px","overflow-y":"auto"}},null,8,["value"])]),_:1})]),_:1}),f("span",G,[e(m,{onClick:n[3]||(n[3]=c=>t.dialogVisible=!1)},{default:a(()=>[p("取消")]),_:1}),e(m,{type:"danger",onClick:u.delete_review},{default:a(()=>[p("删除评论")]),_:1},8,["onClick"]),e(m,{type:"warning",onClick:u.ban_user},{default:a(()=>[p("封禁用户")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])])}const P=j(z,[["render",H],["__scopeId","data-v-6eb8469c"]]);export{P as default};
